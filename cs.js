var Ce=Object.defineProperty;var Ee=(S,I,y)=>I in S?Ce(S,I,{enumerable:!0,configurable:!0,writable:!0,value:y}):S[I]=y;var n=(S,I,y)=>Ee(S,typeof I!="symbol"?I+"":I,y);(function(){"use strict";var q,K,Q,X,Z,B,ee,se,te,re,ne,ie,oe,ae,ce,ue,le,pe;class S extends Error{constructor(t){super(t),this.name="DecodingError"}}class I extends Error{constructor(t){super(t),this.name="EncodingError"}}class y extends Error{constructor(t){super(t),this.name="GVLError"}}class v extends Error{constructor(t,e,s=""){super(`invalid value ${e} passed for ${t} ${s}`),this.name="TCModelError"}}class P{static encode(t){if(!/^[0-1]+$/.test(t))throw new I("Invalid bitField");const e=t.length%this.LCM;t+=e?"0".repeat(this.LCM-e):"";let s="";for(let r=0;r<t.length;r+=this.BASIS)s+=this.DICT[parseInt(t.substr(r,this.BASIS),2)];return s}static decode(t){if(!/^[A-Za-z0-9\-_]+$/.test(t))throw new S("Invalidly encoded Base64URL string");let e="";for(let s=0;s<t.length;s++){const r=this.REVERSE_DICT.get(t[s]).toString(2);e+="0".repeat(this.BASIS-r.length)+r}return e}}n(P,"DICT","ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"),n(P,"REVERSE_DICT",new Map([["A",0],["B",1],["C",2],["D",3],["E",4],["F",5],["G",6],["H",7],["I",8],["J",9],["K",10],["L",11],["M",12],["N",13],["O",14],["P",15],["Q",16],["R",17],["S",18],["T",19],["U",20],["V",21],["W",22],["X",23],["Y",24],["Z",25],["a",26],["b",27],["c",28],["d",29],["e",30],["f",31],["g",32],["h",33],["i",34],["j",35],["k",36],["l",37],["m",38],["n",39],["o",40],["p",41],["q",42],["r",43],["s",44],["t",45],["u",46],["v",47],["w",48],["x",49],["y",50],["z",51],["0",52],["1",53],["2",54],["3",55],["4",56],["5",57],["6",58],["7",59],["8",60],["9",61],["-",62],["_",63]])),n(P,"BASIS",6),n(P,"LCM",24);const V=class V{has(t){return V.langSet.has(t)}parseLanguage(t){t=t.toUpperCase();const e=t.split("-")[0];if(t.length>=2&&e.length==2){if(V.langSet.has(t))return t;if(V.langSet.has(e))return e;const s=e+"-"+e;if(V.langSet.has(s))return s;for(const r of V.langSet)if(r.indexOf(t)!==-1||r.indexOf(e)!==-1)return r}throw new Error(`unsupported language ${t}`)}forEach(t){V.langSet.forEach(t)}get size(){return V.langSet.size}};n(V,"langSet",new Set(["AR","BG","BS","CA","CS","CY","DA","DE","EL","EN","ES","ET","EU","FI","FR","GL","HE","HR","HU","ID","IT","JA","KO","LT","LV","MK","MS","MT","NL","NO","PL","PT-BR","PT-PT","RO","RU","SK","SL","SR-LATN","SR-CYRL","SV","TL","TR","UK","ZH"]));let H=V;class o{}n(o,"cmpId","cmpId"),n(o,"cmpVersion","cmpVersion"),n(o,"consentLanguage","consentLanguage"),n(o,"consentScreen","consentScreen"),n(o,"created","created"),n(o,"supportOOB","supportOOB"),n(o,"isServiceSpecific","isServiceSpecific"),n(o,"lastUpdated","lastUpdated"),n(o,"numCustomPurposes","numCustomPurposes"),n(o,"policyVersion","policyVersion"),n(o,"publisherCountryCode","publisherCountryCode"),n(o,"publisherCustomConsents","publisherCustomConsents"),n(o,"publisherCustomLegitimateInterests","publisherCustomLegitimateInterests"),n(o,"publisherLegitimateInterests","publisherLegitimateInterests"),n(o,"publisherConsents","publisherConsents"),n(o,"publisherRestrictions","publisherRestrictions"),n(o,"purposeConsents","purposeConsents"),n(o,"purposeLegitimateInterests","purposeLegitimateInterests"),n(o,"purposeOneTreatment","purposeOneTreatment"),n(o,"specialFeatureOptins","specialFeatureOptins"),n(o,"useNonStandardTexts","useNonStandardTexts"),n(o,"vendorConsents","vendorConsents"),n(o,"vendorLegitimateInterests","vendorLegitimateInterests"),n(o,"vendorListVersion","vendorListVersion"),n(o,"vendorsAllowed","vendorsAllowed"),n(o,"vendorsDisclosed","vendorsDisclosed"),n(o,"version","version");class _{clone(){const t=new this.constructor;return Object.keys(this).forEach(s=>{const r=this.deepClone(this[s]);r!==void 0&&(t[s]=r)}),t}deepClone(t){const e=typeof t;if(e==="number"||e==="string"||e==="boolean")return t;if(t!==null&&e==="object"){if(typeof t.clone=="function")return t.clone();if(t instanceof Date)return new Date(t.getTime());if(t[Symbol.iterator]!==void 0){const s=[];for(const r of t)s.push(this.deepClone(r));return t instanceof Array?s:new t.constructor(s)}else{const s={};for(const r in t)t.hasOwnProperty(r)&&(s[r]=this.deepClone(t[r]));return s}}}}var L;(function(p){p[p.NOT_ALLOWED=0]="NOT_ALLOWED",p[p.REQUIRE_CONSENT=1]="REQUIRE_CONSENT",p[p.REQUIRE_LI=2]="REQUIRE_LI"})(L||(L={}));const D=class D extends _{constructor(e,s){super();n(this,"purposeId_");n(this,"restrictionType");e!==void 0&&(this.purposeId=e),s!==void 0&&(this.restrictionType=s)}static unHash(e){const s=e.split(this.hashSeparator),r=new D;if(s.length!==2)throw new v("hash",e);return r.purposeId=parseInt(s[0],10),r.restrictionType=parseInt(s[1],10),r}get hash(){if(!this.isValid())throw new Error("cannot hash invalid PurposeRestriction");return`${this.purposeId}${D.hashSeparator}${this.restrictionType}`}get purposeId(){return this.purposeId_}set purposeId(e){this.purposeId_=e}isValid(){return Number.isInteger(this.purposeId)&&this.purposeId>0&&(this.restrictionType===L.NOT_ALLOWED||this.restrictionType===L.REQUIRE_CONSENT||this.restrictionType===L.REQUIRE_LI)}isSameAs(e){return this.purposeId===e.purposeId&&this.restrictionType===e.restrictionType}};n(D,"hashSeparator","-");let O=D;class $ extends _{constructor(){super(...arguments);n(this,"bitLength",0);n(this,"map",new Map);n(this,"gvl_")}has(e){return this.map.has(e)}isOkToHave(e,s,r){var c;let i=!0;if((c=this.gvl)!=null&&c.vendors){const u=this.gvl.vendors[r];if(u)if(e===L.NOT_ALLOWED)i=u.legIntPurposes.includes(s)||u.purposes.includes(s);else if(u.flexiblePurposes.length)switch(e){case L.REQUIRE_CONSENT:i=u.flexiblePurposes.includes(s)&&u.legIntPurposes.includes(s);break;case L.REQUIRE_LI:i=u.flexiblePurposes.includes(s)&&u.purposes.includes(s);break}else i=!1;else i=!1}return i}add(e,s){if(this.isOkToHave(s.restrictionType,s.purposeId,e)){const r=s.hash;this.has(r)||(this.map.set(r,new Set),this.bitLength=0),this.map.get(r).add(e)}}restrictPurposeToLegalBasis(e){const s=Array.from(this.gvl.vendorIds),r=e.hash,i=s[s.length-1],c=[...Array(i).keys()].map(u=>u+1);if(!this.has(r))this.map.set(r,new Set(c)),this.bitLength=0;else for(let u=1;u<=i;u++)this.map.get(r).add(u)}getVendors(e){let s=[];if(e){const r=e.hash;this.has(r)&&(s=Array.from(this.map.get(r)))}else{const r=new Set;this.map.forEach(i=>{i.forEach(c=>{r.add(c)})}),s=Array.from(r)}return s.sort((r,i)=>r-i)}getRestrictionType(e,s){let r;return this.getRestrictions(e).forEach(i=>{i.purposeId===s&&(r===void 0||r>i.restrictionType)&&(r=i.restrictionType)}),r}vendorHasRestriction(e,s){let r=!1;const i=this.getRestrictions(e);for(let c=0;c<i.length&&!r;c++)r=s.isSameAs(i[c]);return r}getMaxVendorId(){let e=0;return this.map.forEach(s=>{e=Math.max(Array.from(s)[s.size-1],e)}),e}getRestrictions(e){const s=[];return this.map.forEach((r,i)=>{e?r.has(e)&&s.push(O.unHash(i)):s.push(O.unHash(i))}),s}getPurposes(){const e=new Set;return this.map.forEach((s,r)=>{e.add(O.unHash(r).purposeId)}),Array.from(e)}remove(e,s){const r=s.hash,i=this.map.get(r);i&&(i.delete(e),i.size==0&&(this.map.delete(r),this.bitLength=0))}set gvl(e){this.gvl_||(this.gvl_=e,this.map.forEach((s,r)=>{const i=O.unHash(r);Array.from(s).forEach(u=>{this.isOkToHave(i.restrictionType,i.purposeId,u)||s.delete(u)})}))}get gvl(){return this.gvl_}isEmpty(){return this.map.size===0}get numRestrictions(){return this.map.size}}var W;(function(p){p.COOKIE="cookie",p.WEB="web",p.APP="app"})(W||(W={}));var m;(function(p){p.CORE="core",p.VENDORS_DISCLOSED="vendorsDisclosed",p.VENDORS_ALLOWED="vendorsAllowed",p.PUBLISHER_TC="publisherTC"})(m||(m={}));class F{}n(F,"ID_TO_KEY",[m.CORE,m.VENDORS_DISCLOSED,m.VENDORS_ALLOWED,m.PUBLISHER_TC]),n(F,"KEY_TO_ID",{[m.CORE]:0,[m.VENDORS_DISCLOSED]:1,[m.VENDORS_ALLOWED]:2,[m.PUBLISHER_TC]:3});class b extends _{constructor(){super(...arguments);n(this,"bitLength",0);n(this,"maxId_",0);n(this,"set_",new Set)}*[Symbol.iterator](){for(let e=1;e<=this.maxId;e++)yield[e,this.has(e)]}values(){return this.set_.values()}get maxId(){return this.maxId_}has(e){return this.set_.has(e)}unset(e){Array.isArray(e)?e.forEach(s=>this.unset(s)):typeof e=="object"?this.unset(Object.keys(e).map(s=>Number(s))):(this.set_.delete(Number(e)),this.bitLength=0,e===this.maxId&&(this.maxId_=0,this.set_.forEach(s=>{this.maxId_=Math.max(this.maxId,s)})))}isIntMap(e){let s=typeof e=="object";return s=s&&Object.keys(e).every(r=>{let i=Number.isInteger(parseInt(r,10));return i=i&&this.isValidNumber(e[r].id),i=i&&e[r].name!==void 0,i}),s}isValidNumber(e){return parseInt(e,10)>0}isSet(e){let s=!1;return e instanceof Set&&(s=Array.from(e).every(this.isValidNumber)),s}set(e){if(Array.isArray(e))e.forEach(s=>this.set(s));else if(this.isSet(e))this.set(Array.from(e));else if(this.isIntMap(e))this.set(Object.keys(e).map(s=>Number(s)));else if(this.isValidNumber(e))this.set_.add(e),this.maxId_=Math.max(this.maxId,e),this.bitLength=0;else throw new v("set()",e,"must be positive integer array, positive integer, Set<number>, or IntMap")}empty(){this.set_=new Set}forEach(e){for(let s=1;s<=this.maxId;s++)e(this.has(s),s)}get size(){return this.set_.size}setAll(e){this.set(e)}}pe=o.cmpId,le=o.cmpVersion,ue=o.consentLanguage,ce=o.consentScreen,ae=o.created,oe=o.isServiceSpecific,ie=o.lastUpdated,ne=o.policyVersion,re=o.publisherCountryCode,te=o.publisherLegitimateInterests,se=o.publisherConsents,ee=o.purposeConsents,B=o.purposeLegitimateInterests,Z=o.purposeOneTreatment,X=o.specialFeatureOptins,Q=o.useNonStandardTexts,K=o.vendorListVersion,q=o.version;class a{}n(a,pe,12),n(a,le,12),n(a,ue,12),n(a,ce,6),n(a,ae,36),n(a,oe,1),n(a,ie,36),n(a,ne,6),n(a,re,12),n(a,te,24),n(a,se,24),n(a,ee,24),n(a,B,24),n(a,Z,1),n(a,X,12),n(a,Q,1),n(a,K,12),n(a,q,6),n(a,"anyBoolean",1),n(a,"encodingType",1),n(a,"maxId",16),n(a,"numCustomPurposes",6),n(a,"numEntries",12),n(a,"numRestrictions",12),n(a,"purposeId",6),n(a,"restrictionType",2),n(a,"segmentType",3),n(a,"singleOrRange",1),n(a,"vendorId",16);class A{static encode(t){return String(Number(t))}static decode(t){return t==="1"}}class h{static encode(t,e){let s;if(typeof t=="string"&&(t=parseInt(t,10)),s=t.toString(2),s.length>e||t<0)throw new I(`${t} too large to encode into ${e}`);return s.length<e&&(s="0".repeat(e-s.length)+s),s}static decode(t,e){if(e!==t.length)throw new S("invalid bit length");return parseInt(t,2)}}class j{static encode(t,e){return h.encode(Math.round(t.getTime()/100),e)}static decode(t,e){if(e!==t.length)throw new S("invalid bit length");const s=new Date;return s.setTime(h.decode(t,e)*100),s}}class T{static encode(t,e){let s="";for(let r=1;r<=e;r++)s+=A.encode(t.has(r));return s}static decode(t,e){if(t.length!==e)throw new S("bitfield encoding length mismatch");const s=new b;for(let r=1;r<=e;r++)A.decode(t[r-1])&&s.set(r);return s.bitLength=t.length,s}}class Y{static encode(t,e){t=t.toUpperCase();const s=65,r=t.charCodeAt(0)-s,i=t.charCodeAt(1)-s;if(r<0||r>25||i<0||i>25)throw new I(`invalid language code: ${t}`);if(e%2===1)throw new I(`numBits must be even, ${e} is not valid`);e=e/2;const c=h.encode(r,e),u=h.encode(i,e);return c+u}static decode(t,e){let s;if(e===t.length&&!(t.length%2)){const i=t.length/2,c=h.decode(t.slice(0,i),i)+65,u=h.decode(t.slice(i),i)+65;s=String.fromCharCode(c)+String.fromCharCode(u)}else throw new S("invalid bit length for language");return s}}class de{static encode(t){let e=h.encode(t.numRestrictions,a.numRestrictions);if(!t.isEmpty()){const s=(r,i)=>{for(let c=r+1;c<=i;c++)if(t.gvl.vendorIds.has(c))return c;return r};t.getRestrictions().forEach(r=>{e+=h.encode(r.purposeId,a.purposeId),e+=h.encode(r.restrictionType,a.restrictionType);const i=t.getVendors(r),c=i.length;let u=0,d=0,g="";for(let f=0;f<c;f++){const E=i[f];if(d===0&&(u++,d=E),f===c-1||i[f+1]>s(E,i[c-1])){const C=E!==d;g+=A.encode(C),g+=h.encode(d,a.vendorId),C&&(g+=h.encode(E,a.vendorId)),d=0}}e+=h.encode(u,a.numEntries),e+=g})}return e}static decode(t){let e=0;const s=new $,r=h.decode(t.substr(e,a.numRestrictions),a.numRestrictions);e+=a.numRestrictions;for(let i=0;i<r;i++){const c=h.decode(t.substr(e,a.purposeId),a.purposeId);e+=a.purposeId;const u=h.decode(t.substr(e,a.restrictionType),a.restrictionType);e+=a.restrictionType;const d=new O(c,u),g=h.decode(t.substr(e,a.numEntries),a.numEntries);e+=a.numEntries;for(let f=0;f<g;f++){const E=A.decode(t.substr(e,a.anyBoolean));e+=a.anyBoolean;const C=h.decode(t.substr(e,a.vendorId),a.vendorId);if(e+=a.vendorId,E){const x=h.decode(t.substr(e,a.vendorId),a.vendorId);if(e+=a.vendorId,x<C)throw new S(`Invalid RangeEntry: endVendorId ${x} is less than ${C}`);for(let M=C;M<=x;M++)s.add(M,d)}else s.add(C,d)}}return s.bitLength=e,s}}var N;(function(p){p[p.FIELD=0]="FIELD",p[p.RANGE=1]="RANGE"})(N||(N={}));class U{static encode(t){const e=[];let s=[],r=h.encode(t.maxId,a.maxId),i="",c;const u=a.maxId+a.encodingType,d=u+t.maxId,g=a.vendorId*2+a.singleOrRange+a.numEntries;let f=u+a.numEntries;return t.forEach((E,C)=>{i+=A.encode(E),c=t.maxId>g&&f<d,c&&E&&(t.has(C+1)?s.length===0&&(s.push(C),f+=a.singleOrRange,f+=a.vendorId):(s.push(C),f+=a.vendorId,e.push(s),s=[]))}),c?(r+=String(N.RANGE),r+=this.buildRangeEncoding(e)):(r+=String(N.FIELD),r+=i),r}static decode(t,e){let s,r=0;const i=h.decode(t.substr(r,a.maxId),a.maxId);r+=a.maxId;const c=h.decode(t.charAt(r),a.encodingType);if(r+=a.encodingType,c===N.RANGE){if(s=new b,e===1){if(t.substr(r,1)==="1")throw new S("Unable to decode default consent=1");r++}const u=h.decode(t.substr(r,a.numEntries),a.numEntries);r+=a.numEntries;for(let d=0;d<u;d++){const g=A.decode(t.charAt(r));r+=a.singleOrRange;const f=h.decode(t.substr(r,a.vendorId),a.vendorId);if(r+=a.vendorId,g){const E=h.decode(t.substr(r,a.vendorId),a.vendorId);r+=a.vendorId;for(let C=f;C<=E;C++)s.set(C)}else s.set(f)}}else{const u=t.substr(r,i);r+=i,s=T.decode(u,i)}return s.bitLength=r,s}static buildRangeEncoding(t){const e=t.length;let s=h.encode(e,a.numEntries);return t.forEach(r=>{const i=r.length===1;s+=A.encode(!i),s+=h.encode(r[0],a.vendorId),i||(s+=h.encode(r[1],a.vendorId))}),s}}function z(){return{[o.version]:h,[o.created]:j,[o.lastUpdated]:j,[o.cmpId]:h,[o.cmpVersion]:h,[o.consentScreen]:h,[o.consentLanguage]:Y,[o.vendorListVersion]:h,[o.policyVersion]:h,[o.isServiceSpecific]:A,[o.useNonStandardTexts]:A,[o.specialFeatureOptins]:T,[o.purposeConsents]:T,[o.purposeLegitimateInterests]:T,[o.purposeOneTreatment]:A,[o.publisherCountryCode]:Y,[o.vendorConsents]:U,[o.vendorLegitimateInterests]:U,[o.publisherRestrictions]:de,segmentType:h,[o.vendorsDisclosed]:U,[o.vendorsAllowed]:U,[o.publisherConsents]:T,[o.publisherLegitimateInterests]:T,[o.numCustomPurposes]:h,[o.publisherCustomConsents]:T,[o.publisherCustomLegitimateInterests]:T}}class he{constructor(){n(this,1,{[m.CORE]:[o.version,o.created,o.lastUpdated,o.cmpId,o.cmpVersion,o.consentScreen,o.consentLanguage,o.vendorListVersion,o.purposeConsents,o.vendorConsents]});n(this,2,{[m.CORE]:[o.version,o.created,o.lastUpdated,o.cmpId,o.cmpVersion,o.consentScreen,o.consentLanguage,o.vendorListVersion,o.policyVersion,o.isServiceSpecific,o.useNonStandardTexts,o.specialFeatureOptins,o.purposeConsents,o.purposeLegitimateInterests,o.purposeOneTreatment,o.publisherCountryCode,o.vendorConsents,o.vendorLegitimateInterests,o.publisherRestrictions],[m.PUBLISHER_TC]:[o.publisherConsents,o.publisherLegitimateInterests,o.numCustomPurposes,o.publisherCustomConsents,o.publisherCustomLegitimateInterests],[m.VENDORS_ALLOWED]:[o.vendorsAllowed],[m.VENDORS_DISCLOSED]:[o.vendorsDisclosed]})}}class fe{constructor(t,e){n(this,1,[m.CORE]);n(this,2,[m.CORE]);if(t.version===2)if(t.isServiceSpecific)this[2].push(m.PUBLISHER_TC);else{const s=!!(e&&e.isForVendors);(!s||t[o.supportOOB]===!0)&&this[2].push(m.VENDORS_DISCLOSED),s&&(t[o.supportOOB]&&t[o.vendorsAllowed].size>0&&this[2].push(m.VENDORS_ALLOWED),this[2].push(m.PUBLISHER_TC))}}}class G{static encode(t,e){let s;try{s=this.fieldSequence[String(t.version)][e]}catch{throw new I(`Unable to encode version: ${t.version}, segment: ${e}`)}let r="";e!==m.CORE&&(r=h.encode(F.KEY_TO_ID[e],a.segmentType));const i=z();return s.forEach(c=>{const u=t[c],d=i[c];let g=a[c];g===void 0&&this.isPublisherCustom(c)&&(g=Number(t[o.numCustomPurposes]));try{r+=d.encode(u,g)}catch(f){throw new I(`Error encoding ${e}->${c}: ${f.message}`)}}),P.encode(r)}static decode(t,e,s){const r=P.decode(t);let i=0;s===m.CORE&&(e.version=h.decode(r.substr(i,a[o.version]),a[o.version])),s!==m.CORE&&(i+=a.segmentType);const c=this.fieldSequence[String(e.version)][s],u=z();return c.forEach(d=>{const g=u[d];let f=a[d];if(f===void 0&&this.isPublisherCustom(d)&&(f=Number(e[o.numCustomPurposes])),f!==0){const E=r.substr(i,f);if(g===U?e[d]=g.decode(E,e.version):e[d]=g.decode(E,f),Number.isInteger(f))i+=f;else if(Number.isInteger(e[d].bitLength))i+=e[d].bitLength;else throw new S(d)}}),e}static isPublisherCustom(t){return t.indexOf("publisherCustom")===0}}n(G,"fieldSequence",new he);class J{static process(t,e){const s=t.gvl;if(!s)throw new I("Unable to encode TCModel without a GVL");if(!s.isReady)throw new I("Unable to encode TCModel tcModel.gvl.readyPromise is not resolved");t=t.clone(),t.consentLanguage=s.language.slice(0,2).toUpperCase(),(e==null?void 0:e.version)>0&&(e==null?void 0:e.version)<=this.processor.length?t.version=e.version:t.version=this.processor.length;const r=t.version-1;if(!this.processor[r])throw new I(`Invalid version: ${t.version}`);return this.processor[r](t,s)}}n(J,"processor",[t=>t,(t,e)=>{t.publisherRestrictions.gvl=e,t.purposeLegitimateInterests.unset([1,3,4,5,6]);const s=new Map;return s.set("legIntPurposes",t.vendorLegitimateInterests),s.set("purposes",t.vendorConsents),s.forEach((r,i)=>{r.forEach((c,u)=>{if(c){const d=e.vendors[u];if(!d||d.deletedDate)r.unset(u);else if(d[i].length===0&&!(i==="legIntPurposes"&&d.purposes.length===0&&d.legIntPurposes.length===0&&d.specialPurposes.length>0))if(t.isServiceSpecific)if(d.flexiblePurposes.length===0)r.unset(u);else{const g=t.publisherRestrictions.getRestrictions(u);let f=!1;for(let E=0,C=g.length;E<C&&!f;E++)f=g[E].restrictionType===L.REQUIRE_CONSENT&&i==="purposes"||g[E].restrictionType===L.REQUIRE_LI&&i==="legIntPurposes";f||r.unset(u)}else r.unset(u)}})}),t.vendorsDisclosed.set(e.vendors),t}]);class ge{static absCall(t,e,s,r){return new Promise((i,c)=>{const u=new XMLHttpRequest,d=()=>{if(u.readyState==XMLHttpRequest.DONE)if(u.status>=200&&u.status<300){let C=u.response;if(typeof C=="string")try{C=JSON.parse(C)}catch{}i(C)}else c(new Error(`HTTP Status: ${u.status} response type: ${u.responseType}`))},g=()=>{c(new Error("error"))},f=()=>{c(new Error("aborted"))},E=()=>{c(new Error("Timeout "+r+"ms "+t))};u.withCredentials=s,u.addEventListener("load",d),u.addEventListener("error",g),u.addEventListener("abort",f),e===null?u.open("GET",t,!0):u.open("POST",t,!0),u.responseType="json",u.timeout=r,u.ontimeout=E,u.send(e)})}static post(t,e,s=!1,r=0){return this.absCall(t,JSON.stringify(e),s,r)}static fetch(t,e=!1,s=0){return this.absCall(t,null,e,s)}}const l=class l extends _{constructor(e,s){super();n(this,"readyPromise");n(this,"gvlSpecificationVersion");n(this,"vendorListVersion");n(this,"tcfPolicyVersion");n(this,"lastUpdated");n(this,"purposes");n(this,"specialPurposes");n(this,"features");n(this,"specialFeatures");n(this,"isReady_",!1);n(this,"vendors_");n(this,"vendorIds");n(this,"fullVendorList");n(this,"byPurposeVendorMap");n(this,"bySpecialPurposeVendorMap");n(this,"byFeatureVendorMap");n(this,"bySpecialFeatureVendorMap");n(this,"stacks");n(this,"dataCategories");n(this,"lang_");n(this,"cacheLang_");n(this,"isLatest",!1);let r=l.baseUrl,i=s==null?void 0:s.language;if(i)try{i=l.consentLanguages.parseLanguage(i)}catch(c){throw new y("Error during parsing the language: "+c.message)}if(this.lang_=i||l.DEFAULT_LANGUAGE,this.cacheLang_=i||l.DEFAULT_LANGUAGE,this.isVendorList(e))this.populate(e),this.readyPromise=Promise.resolve();else{if(!r)throw new y("must specify GVL.baseUrl before loading GVL json");if(e>0){const c=e;l.CACHE.has(c)?(this.populate(l.CACHE.get(c)),this.readyPromise=Promise.resolve()):(r+=l.versionedFilename.replace("[VERSION]",String(c)),this.readyPromise=this.fetchJson(r))}else l.CACHE.has(l.LATEST_CACHE_KEY)?(this.populate(l.CACHE.get(l.LATEST_CACHE_KEY)),this.readyPromise=Promise.resolve()):(this.isLatest=!0,this.readyPromise=this.fetchJson(r+l.latestFilename))}}static set baseUrl(e){if(/^https?:\/\/vendorlist\.consensu\.org\//.test(e))throw new y("Invalid baseUrl!  You may not pull directly from vendorlist.consensu.org and must provide your own cache");e.length>0&&e[e.length-1]!=="/"&&(e+="/"),this.baseUrl_=e}static get baseUrl(){return this.baseUrl_}static emptyLanguageCache(e){let s=!1;return e==null&&l.LANGUAGE_CACHE.size>0?(l.LANGUAGE_CACHE=new Map,s=!0):typeof e=="string"&&this.consentLanguages.has(e.toUpperCase())&&(l.LANGUAGE_CACHE.delete(e.toUpperCase()),s=!0),s}static emptyCache(e){let s=!1;return Number.isInteger(e)&&e>=0?(l.CACHE.delete(e),s=!0):e===void 0&&(l.CACHE=new Map,s=!0),s}cacheLanguage(){l.LANGUAGE_CACHE.has(this.cacheLang_)||l.LANGUAGE_CACHE.set(this.cacheLang_,{purposes:this.purposes,specialPurposes:this.specialPurposes,features:this.features,specialFeatures:this.specialFeatures,stacks:this.stacks,dataCategories:this.dataCategories})}async fetchJson(e){try{this.populate(await ge.fetch(e))}catch(s){throw new y(s.message)}}getJson(){return{gvlSpecificationVersion:this.gvlSpecificationVersion,vendorListVersion:this.vendorListVersion,tcfPolicyVersion:this.tcfPolicyVersion,lastUpdated:this.lastUpdated,purposes:this.clonePurposes(),specialPurposes:this.cloneSpecialPurposes(),features:this.cloneFeatures(),specialFeatures:this.cloneSpecialFeatures(),stacks:this.cloneStacks(),...this.dataCategories?{dataCategories:this.cloneDataCategories()}:{},vendors:this.cloneVendors()}}cloneSpecialFeatures(){const e={};for(const s of Object.keys(this.specialFeatures))e[s]=l.cloneFeature(this.specialFeatures[s]);return e}cloneFeatures(){const e={};for(const s of Object.keys(this.features))e[s]=l.cloneFeature(this.features[s]);return e}cloneStacks(){const e={};for(const s of Object.keys(this.stacks))e[s]=l.cloneStack(this.stacks[s]);return e}cloneDataCategories(){const e={};for(const s of Object.keys(this.dataCategories))e[s]=l.cloneDataCategory(this.dataCategories[s]);return e}cloneSpecialPurposes(){const e={};for(const s of Object.keys(this.specialPurposes))e[s]=l.clonePurpose(this.specialPurposes[s]);return e}clonePurposes(){const e={};for(const s of Object.keys(this.purposes))e[s]=l.clonePurpose(this.purposes[s]);return e}static clonePurpose(e){return{id:e.id,name:e.name,description:e.description,...e.descriptionLegal?{descriptionLegal:e.descriptionLegal}:{},...e.illustrations?{illustrations:Array.from(e.illustrations)}:{}}}static cloneFeature(e){return{id:e.id,name:e.name,description:e.description,...e.descriptionLegal?{descriptionLegal:e.descriptionLegal}:{},...e.illustrations?{illustrations:Array.from(e.illustrations)}:{}}}static cloneDataCategory(e){return{id:e.id,name:e.name,description:e.description}}static cloneStack(e){return{id:e.id,name:e.name,description:e.description,purposes:Array.from(e.purposes),specialFeatures:Array.from(e.specialFeatures)}}static cloneDataRetention(e){return{...typeof e.stdRetention=="number"?{stdRetention:e.stdRetention}:{},purposes:{...e.purposes},specialPurposes:{...e.specialPurposes}}}static cloneVendorUrls(e){return e.map(s=>({langId:s.langId,privacy:s.privacy,...s.legIntClaim?{legIntClaim:s.legIntClaim}:{}}))}static cloneVendor(e){return{id:e.id,name:e.name,purposes:Array.from(e.purposes),legIntPurposes:Array.from(e.legIntPurposes),flexiblePurposes:Array.from(e.flexiblePurposes),specialPurposes:Array.from(e.specialPurposes),features:Array.from(e.features),specialFeatures:Array.from(e.specialFeatures),...e.overflow?{overflow:{httpGetLimit:e.overflow.httpGetLimit}}:{},...typeof e.cookieMaxAgeSeconds=="number"||e.cookieMaxAgeSeconds===null?{cookieMaxAgeSeconds:e.cookieMaxAgeSeconds}:{},...e.usesCookies!==void 0?{usesCookies:e.usesCookies}:{},...e.policyUrl?{policyUrl:e.policyUrl}:{},...e.cookieRefresh!==void 0?{cookieRefresh:e.cookieRefresh}:{},...e.usesNonCookieAccess!==void 0?{usesNonCookieAccess:e.usesNonCookieAccess}:{},...e.dataRetention?{dataRetention:this.cloneDataRetention(e.dataRetention)}:{},...e.urls?{urls:this.cloneVendorUrls(e.urls)}:{},...e.dataDeclaration?{dataDeclaration:Array.from(e.dataDeclaration)}:{},...e.deviceStorageDisclosureUrl?{deviceStorageDisclosureUrl:e.deviceStorageDisclosureUrl}:{},...e.deletedDate?{deletedDate:e.deletedDate}:{}}}cloneVendors(){const e={};for(const s of Object.keys(this.fullVendorList))e[s]=l.cloneVendor(this.fullVendorList[s]);return e}async changeLanguage(e){let s=e;try{s=l.consentLanguages.parseLanguage(e)}catch(i){throw new y("Error during parsing the language: "+i.message)}const r=e.toUpperCase();if(!(s.toLowerCase()===l.DEFAULT_LANGUAGE.toLowerCase()&&!l.LANGUAGE_CACHE.has(r))&&s!==this.lang_)if(this.lang_=s,l.LANGUAGE_CACHE.has(r)){const i=l.LANGUAGE_CACHE.get(r);for(const c in i)i.hasOwnProperty(c)&&(this[c]=i[c])}else{const i=l.baseUrl+l.languageFilename.replace("[LANG]",this.lang_.toLowerCase());try{await this.fetchJson(i),this.cacheLang_=r,this.cacheLanguage()}catch(c){throw new y("unable to load language: "+c.message)}}}get language(){return this.lang_}isVendorList(e){return e!==void 0&&e.vendors!==void 0}populate(e){this.purposes=e.purposes,this.specialPurposes=e.specialPurposes,this.features=e.features,this.specialFeatures=e.specialFeatures,this.stacks=e.stacks,this.dataCategories=e.dataCategories,this.isVendorList(e)&&(this.gvlSpecificationVersion=e.gvlSpecificationVersion,this.tcfPolicyVersion=e.tcfPolicyVersion,this.vendorListVersion=e.vendorListVersion,this.lastUpdated=e.lastUpdated,typeof this.lastUpdated=="string"&&(this.lastUpdated=new Date(this.lastUpdated)),this.vendors_=e.vendors,this.fullVendorList=e.vendors,this.mapVendors(),this.isReady_=!0,this.isLatest&&l.CACHE.set(l.LATEST_CACHE_KEY,this.getJson()),l.CACHE.has(this.vendorListVersion)||l.CACHE.set(this.vendorListVersion,this.getJson())),this.cacheLanguage()}mapVendors(e){this.byPurposeVendorMap={},this.bySpecialPurposeVendorMap={},this.byFeatureVendorMap={},this.bySpecialFeatureVendorMap={},Object.keys(this.purposes).forEach(s=>{this.byPurposeVendorMap[s]={legInt:new Set,consent:new Set,flexible:new Set}}),Object.keys(this.specialPurposes).forEach(s=>{this.bySpecialPurposeVendorMap[s]=new Set}),Object.keys(this.features).forEach(s=>{this.byFeatureVendorMap[s]=new Set}),Object.keys(this.specialFeatures).forEach(s=>{this.bySpecialFeatureVendorMap[s]=new Set}),Array.isArray(e)||(e=Object.keys(this.fullVendorList).map(s=>+s)),this.vendorIds=new Set(e),this.vendors_=e.reduce((s,r)=>{const i=this.vendors_[String(r)];return i&&i.deletedDate===void 0&&(i.purposes.forEach(c=>{this.byPurposeVendorMap[String(c)].consent.add(r)}),i.specialPurposes.forEach(c=>{this.bySpecialPurposeVendorMap[String(c)].add(r)}),i.legIntPurposes.forEach(c=>{this.byPurposeVendorMap[String(c)].legInt.add(r)}),i.flexiblePurposes&&i.flexiblePurposes.forEach(c=>{this.byPurposeVendorMap[String(c)].flexible.add(r)}),i.features.forEach(c=>{this.byFeatureVendorMap[String(c)].add(r)}),i.specialFeatures.forEach(c=>{this.bySpecialFeatureVendorMap[String(c)].add(r)}),s[r]=i),s},{})}getFilteredVendors(e,s,r,i){const c=e.charAt(0).toUpperCase()+e.slice(1);let u;const d={};return e==="purpose"&&r?u=this["by"+c+"VendorMap"][String(s)][r]:u=this["by"+(i?"Special":"")+c+"VendorMap"][String(s)],u.forEach(g=>{d[String(g)]=this.vendors[String(g)]}),d}getVendorsWithConsentPurpose(e){return this.getFilteredVendors("purpose",e,"consent")}getVendorsWithLegIntPurpose(e){return this.getFilteredVendors("purpose",e,"legInt")}getVendorsWithFlexiblePurpose(e){return this.getFilteredVendors("purpose",e,"flexible")}getVendorsWithSpecialPurpose(e){return this.getFilteredVendors("purpose",e,void 0,!0)}getVendorsWithFeature(e){return this.getFilteredVendors("feature",e)}getVendorsWithSpecialFeature(e){return this.getFilteredVendors("feature",e,void 0,!0)}get vendors(){return this.vendors_}narrowVendorsTo(e){this.mapVendors(e)}get isReady(){return this.isReady_}clone(){const e=new l(this.getJson());return this.lang_!==l.DEFAULT_LANGUAGE&&e.changeLanguage(this.lang_),e}static isInstanceOf(e){return typeof e=="object"&&typeof e.narrowVendorsTo=="function"}};n(l,"LANGUAGE_CACHE",new Map),n(l,"CACHE",new Map),n(l,"LATEST_CACHE_KEY",0),n(l,"DEFAULT_LANGUAGE","EN"),n(l,"consentLanguages",new H),n(l,"baseUrl_"),n(l,"latestFilename","vendor-list.json"),n(l,"versionedFilename","archives/vendor-list-v[VERSION].json"),n(l,"languageFilename","purposes-[LANG].json");let R=l;class k extends _{constructor(e){super();n(this,"isServiceSpecific_",!1);n(this,"supportOOB_",!0);n(this,"useNonStandardTexts_",!1);n(this,"purposeOneTreatment_",!1);n(this,"publisherCountryCode_","AA");n(this,"version_",2);n(this,"consentScreen_",0);n(this,"policyVersion_",4);n(this,"consentLanguage_","EN");n(this,"cmpId_",0);n(this,"cmpVersion_",0);n(this,"vendorListVersion_",0);n(this,"numCustomPurposes_",0);n(this,"gvl_");n(this,"created");n(this,"lastUpdated");n(this,"specialFeatureOptins",new b);n(this,"purposeConsents",new b);n(this,"purposeLegitimateInterests",new b);n(this,"publisherConsents",new b);n(this,"publisherLegitimateInterests",new b);n(this,"publisherCustomConsents",new b);n(this,"publisherCustomLegitimateInterests",new b);n(this,"customPurposes");n(this,"vendorConsents",new b);n(this,"vendorLegitimateInterests",new b);n(this,"vendorsDisclosed",new b);n(this,"vendorsAllowed",new b);n(this,"publisherRestrictions",new $);e&&(this.gvl=e),this.updated()}set gvl(e){R.isInstanceOf(e)||(e=new R(e)),this.gvl_=e,this.publisherRestrictions.gvl=e}get gvl(){return this.gvl_}set cmpId(e){if(e=Number(e),Number.isInteger(e)&&e>1)this.cmpId_=e;else throw new v("cmpId",e)}get cmpId(){return this.cmpId_}set cmpVersion(e){if(e=Number(e),Number.isInteger(e)&&e>-1)this.cmpVersion_=e;else throw new v("cmpVersion",e)}get cmpVersion(){return this.cmpVersion_}set consentScreen(e){if(e=Number(e),Number.isInteger(e)&&e>-1)this.consentScreen_=e;else throw new v("consentScreen",e)}get consentScreen(){return this.consentScreen_}set consentLanguage(e){this.consentLanguage_=e}get consentLanguage(){return this.consentLanguage_}set publisherCountryCode(e){if(/^([A-z]){2}$/.test(e))this.publisherCountryCode_=e.toUpperCase();else throw new v("publisherCountryCode",e)}get publisherCountryCode(){return this.publisherCountryCode_}set vendorListVersion(e){if(e=Number(e)>>0,e<0)throw new v("vendorListVersion",e);this.vendorListVersion_=e}get vendorListVersion(){return this.gvl?this.gvl.vendorListVersion:this.vendorListVersion_}set policyVersion(e){if(this.policyVersion_=parseInt(e,10),this.policyVersion_<0)throw new v("policyVersion",e)}get policyVersion(){return this.gvl?this.gvl.tcfPolicyVersion:this.policyVersion_}set version(e){this.version_=parseInt(e,10)}get version(){return this.version_}set isServiceSpecific(e){this.isServiceSpecific_=e}get isServiceSpecific(){return this.isServiceSpecific_}set useNonStandardTexts(e){this.useNonStandardTexts_=e}get useNonStandardTexts(){return this.useNonStandardTexts_}set supportOOB(e){this.supportOOB_=e}get supportOOB(){return this.supportOOB_}set purposeOneTreatment(e){this.purposeOneTreatment_=e}get purposeOneTreatment(){return this.purposeOneTreatment_}setAllVendorConsents(){this.vendorConsents.set(this.gvl.vendors)}unsetAllVendorConsents(){this.vendorConsents.empty()}setAllVendorsDisclosed(){this.vendorsDisclosed.set(this.gvl.vendors)}unsetAllVendorsDisclosed(){this.vendorsDisclosed.empty()}setAllVendorsAllowed(){this.vendorsAllowed.set(this.gvl.vendors)}unsetAllVendorsAllowed(){this.vendorsAllowed.empty()}setAllVendorLegitimateInterests(){this.vendorLegitimateInterests.set(this.gvl.vendors)}unsetAllVendorLegitimateInterests(){this.vendorLegitimateInterests.empty()}setAllPurposeConsents(){this.purposeConsents.set(this.gvl.purposes)}unsetAllPurposeConsents(){this.purposeConsents.empty()}setAllPurposeLegitimateInterests(){this.purposeLegitimateInterests.set(this.gvl.purposes)}unsetAllPurposeLegitimateInterests(){this.purposeLegitimateInterests.empty()}setAllSpecialFeatureOptins(){this.specialFeatureOptins.set(this.gvl.specialFeatures)}unsetAllSpecialFeatureOptins(){this.specialFeatureOptins.empty()}setAll(){this.setAllVendorConsents(),this.setAllPurposeLegitimateInterests(),this.setAllSpecialFeatureOptins(),this.setAllPurposeConsents(),this.setAllVendorLegitimateInterests()}unsetAll(){this.unsetAllVendorConsents(),this.unsetAllPurposeLegitimateInterests(),this.unsetAllSpecialFeatureOptins(),this.unsetAllPurposeConsents(),this.unsetAllVendorLegitimateInterests()}get numCustomPurposes(){let e=this.numCustomPurposes_;if(typeof this.customPurposes=="object"){const s=Object.keys(this.customPurposes).sort((r,i)=>Number(r)-Number(i));e=parseInt(s.pop(),10)}return e}set numCustomPurposes(e){if(this.numCustomPurposes_=parseInt(e,10),this.numCustomPurposes_<0)throw new v("numCustomPurposes",e)}updated(){const e=new Date,s=new Date(Date.UTC(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()));this.created=s,this.lastUpdated=s}}n(k,"consentLanguages",R.consentLanguages);class me{static encode(t,e){let s="",r;return t=J.process(t,e),Array.isArray(e==null?void 0:e.segments)?r=e.segments:r=new fe(t,e)[""+t.version],r.forEach((i,c)=>{let u="";c<r.length-1&&(u="."),s+=G.encode(t,i)+u}),s}static decode(t,e){const s=t.split("."),r=s.length;e||(e=new k);for(let i=0;i<r;i++){const c=s[i],d=P.decode(c.charAt(0)).substr(0,a.segmentType),g=F.ID_TO_KEY[h.decode(d,a.segmentType).toString()];G.decode(c,e,g)}return e}}R.baseUrl="https://rjhdby.github.io/";const w=new k(new R);window.consentString=()=>w.gvl.readyPromise.then(()=>(w.cmpId=327,w.cmpVersion=1,w.consentLanguage="en",w.consentScreen=1,w.publisherCountryCode="CY",w.setAll(),w.publisherConsents.set([1,2,3,4,5,6,7,8,9,10]),w.publisherLegitimateInterests.set([1,2,3,4,5,6,7,8,9,10]),me.encode(w)))})();
